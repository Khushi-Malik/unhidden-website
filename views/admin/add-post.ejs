<a href="/dashboard">&larr; Back to Dashboard</a>
<div class="admin-title">
    <h2>Add New Post</h2>
</div>

<form action="/add-post" method="POST" id="postForm">
    <label for="title">Title</label>
    <input type="text" placeholder="Post Title" name="title" required>

    <label for="body">Content</label>
    <textarea id="editor" name="body" placeholder="Content"></textarea>

    <input type="submit" value="Add Post" class="btn">
</form>

<!-- TinyMCE Editor -->
<script src="https://cdn.tiny.cloud/1/<%= process.env.TINYMCE_API_KEY %>/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
<script>
  tinymce.init({
    selector: '#editor',
    height: 500,
    menubar: false,
    plugins: [
      'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
      'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
      'insertdatetime', 'media', 'table', 'help', 'wordcount'
    ],
    toolbar: 'undo redo | blocks | ' +
      'bold italic forecolor | alignleft aligncenter ' +
      'alignright alignjustify | bullist numlist outdent indent | ' +
      'removeformat | help',
    content_style: 'body { font-family: Poppins, sans-serif; font-size:14px }',
    
    // Validate on form submit
    setup: function (editor) {
      editor.on('init', function () {
        const form = document.getElementById('postForm');
        form.addEventListener('submit', function (e) {
          // Get content from TinyMCE
          const content = editor.getContent();
          
          // Check if content is empty
          if (!content || content.trim() === '') {
            e.preventDefault();
            alert('Please add some content to your post');
            editor.focus();
            return false;
          }
        });
      });
    }
  });
</script>
